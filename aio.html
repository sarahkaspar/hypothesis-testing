<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>Hypothesis testing in biology: All in One View</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="assets/styles.css">
<script src="assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [ ['$','$'], ['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="manifest" href="site.webmanifest">
<link rel="mask-icon" href="safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
</head>
<body>
    <header id="top" class="navbar navbar-expand-md navbar-light bg-white top-nav incubator"><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-6">
      <div class="large-logo">
        <img alt="Carpentries Incubator" src="assets/images/incubator-logo.svg"><abbr class="icon" title="This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught." style="text-decoration: unset">
          Â 
          <a href="https://cdh.carpentries.org/the-lesson-life-cycle.html#early-development-pre-alpha-through-alpha" class="external-link alert-link" style="color: #383838">Pre-Alpha
            <i aria-hidden="true" class="icon" data-feather="alert-octagon" style="color: #FF4955; border-radius: 5px"></i>
          </a>
          <span class="visually-hidden">This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.</span>
        </abbr>
        
      </div>
    </div>
    <div class="selector-container ">
      
      
      <div class="dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Learner View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
<li><button class="dropdown-item" type="button" onclick="window.location.href='instructor/aio.html';">Instructor View</button></li>
        </ul>
</div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl navbar-light bg-white bottom-nav incubator" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Carpentries Incubator" src="assets/images/incubator-logo-sm.svg">
</div>
    <div class="lesson-title-md">
      Hypothesis testing in biology
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
      <i role="img" aria-label="search button" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
<li class="nav-item">
          <span class="lesson-title">
            Hypothesis testing in biology
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="reference.html#glossary">Glossary</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="profiles.html">Learner Profiles</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"></ul>
</li>
      </ul>
</div>
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
<input class="form-control me-2 searchbox" type="search" placeholder="Search" aria-label="Search"><button class="btn btn-outline-success tablet-search-button" type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="search button"></i>
        </button>
      </fieldset>
</form>
  </div>
<!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Hypothesis testing in biology
</div>

<aside class="col-md-12 lesson-progress"><div style="width: %" class="percentage">
    %
  </div>
  <div class="progress incubator">
    <div class="progress-bar incubator" role="progressbar" style="width: %" aria-valuenow="" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
  <div id="sidebar-col" class="col-lg-4">
    <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle"><i class="search-icon" data-feather="x" role="img"></i></button>
        <div class="sidebar-inner">
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Learner View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="instructor/aio.html">Instructor View</a>
                      </div>
                    </div>
                  </div>
<!--/div.accordion-item-->
                </div>
<!--/div.accordion-flush-->
              </div>
<!--div.sidenav-view-selector -->
            </div>
<!--/div.col -->
      
            <hr>
</div>
<!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Setup</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="01-overview.html">1. Overview and motivation</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="02-first-test.html">2. Our first test: Disease prevalence</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="03-two-sided-test.html">3. One-sided vs. two-sided tests, and data snooping</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="04-errors-in-hypothesis-testing.html">4. Errors in hypothesis testing</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="05-one-sample-t-test.html">5. One-sample t-test</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="06-CLT.html">6. The distribution of t according to the Central Limit Theorem</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="07-t-practice.html">7. The distribution of t in practice</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush9">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading9">
        <a href="08-two-sample-t-test.html">8. The two-sample and paired t-test</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush10">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading10">
        <a href="09-interpreting-p-values.html">9. Interpreting p-values</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush11">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading11">
        <a href="10-summary.html">10. Summary and practical aspects</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush12">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading12">
        <a href="11-references.html">11. References</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width">
<div class="accordion accordion-flush resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul>
<li>
                        <a href="key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="reference.html#glossary">Glossary</a>
                      </li>
                      <li>
                        <a href="profiles.html">Learner Profiles</a>
                      </li>
                      
                    </ul>
</div>
                </div>
              </div>
            </div>
            <hr class="half-width resources">
<a href="aio.html">See all in one page</a>

            <hr class="d-none d-sm-block d-md-none">
<div class="d-grid gap-1">
            
            </div>
          </div>
<!-- /div.accordion -->
        </div>
<!-- /div.sidebar-inner -->
      </nav>
</div>
<!-- /div.sidebar -->
  </div>
<!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-extra.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <main id="main-content" class="main-content"><div class="container lesson-content">
        
        
<section id="aio-01-overview"><p>Content from <a href="01-overview.html">Overview and motivation</a></p>
<hr>
<p> Last updated on 2023-05-03 | 
        
        <a href="https://github.com/carpentries/workbench-template-rmd/edit/main/episodes/01-overview.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What is a hypothesis test used for?</li>
<li>What are the general steps of a hypothesis test?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Introduce an example scenario for hypothesis testing.</li>
<li>Describe null and alternative hypothesis.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="an-example">An example<a class="anchor" aria-label="anchor" href="#an-example"></a>
</h3>
<p>What is a hypothesis test, and why do we need it? Consider the
following example:</p>
<figure><img src="fig/01-example.png" alt="mice with different diets" width="500" class="figure mx-auto d-block"><figcaption>Mice with different diets</figcaption></figure><p>Researchers want to show that mice that are fed with a special âhigh
fatâ diet, grow to a different weight than mice that live on a normal,
control diet. They feed a group of mice with the control diet, and
another group of mice with the high fat diet. After a couple of weeks,
they measure the weight.</p>
<figure><img src="fig/01-mice-plot.png" alt="Graph with mice weight measurements" width="600" class="figure mx-auto d-block"><figcaption>Does the diet affect the miceâs weight?</figcaption></figure><p>The above graph shows you a subset of a real data set from <a href="https://pubmed.ncbi.nlm.nih.gov/15561913/" class="external-link">this paper</a>. You see
the individual control mice on the left, and the high fat mice on the
right. The boxes that are overlaid indicate the median weights of both
groups. The <strong>scientific question</strong> is whether the high fat
diet has an impact on the weight. And phrased in a quantitative manner,
we can ask whether there is a difference in weight between the mice from
the two different groups. On the graph we certainly see a difference in
means, but the problem is, of course, that <strong>this difference could
be due to chance</strong>. Because we only have a sample of mice for
each diet, and there is obviously some variation in the mouse weights.
The good news is: If we know the rules for this variation, we can
calculate how likely it is to see this difference by chance â which is
exactly what a statistical test does.</p>
</div>
<div class="section level3">
<h3 id="a-statistical-model">A statistical model<a class="anchor" aria-label="anchor" href="#a-statistical-model"></a>
</h3>
<p>When testing, we assume a statistical model for the data, for example
we say that the weight of the individual mice is the composed of the
diet effect (in this case the group means), plus something called
residuals, which describe the effect of variation, and which follow a
some distribution. If we measure mice weights, we will most likely
assume that the residuals follow a Gaussian distribution, that means the
weights show a bell shaped distribution around the group means.</p>
</div>
<div class="section level3">
<h3 id="null-and-alternative-model">Null and alternative model<a class="anchor" aria-label="anchor" href="#null-and-alternative-model"></a>
</h3>
<p>Actually, itâs not only one model, but two: The null model, and the
alternative model, which describe the null and the alternative
hypothesis.</p>
<table class="table">
<caption>Null and alternative model</caption>
<colgroup>
<col width="21%">
<col width="41%">
<col width="36%">
</colgroup>
<thead><tr class="header">
<th>Hypothesis</th>
<th>Description</th>
<th>Corresponding model</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Null hypothesis (H0)</td>
<td>There is no difference between the two diet groups.</td>
<td><span class="math inline">\(\text{weight} = \text{grand mean} +
\text{residuals}\)</span></td>
</tr>
<tr class="even">
<td>Alternative hypothesis (H1)</td>
<td>There is a difference between the two diet groups.</td>
<td><span class="math inline">\(\text{weight} = \text{group means} +
\text{residuals}\)</span></td>
</tr>
</tbody>
</table>
<p>We start by assuming that there is nothing to see in the data. This
is called the null hypothesis. In this case, the null hypothesis is that
there is no difference between the two groups of mice. This is described
by the <strong>null model</strong>, where the data are sufficiently
described by an overall average weight (not distinguishing between
diets) and individual differences, called residuals. We reject the null
hypothesis when â assuming it was true â it would be very unlikely to
observe a difference as extreme as in our data just by chance.<br>
In this case, we accept the alternative hypothesis â that there is a
difference in weights. This hypothesis is described by an
<strong>alternative model</strong>, which includes the diet as a
variable. So in summary, we use quantitative models to be able to
calculate the probability of our data under the hypothesis that we want
to test.</p>
</div>
<div class="section level3">
<h3 id="steps-of-hypothesis-testing">Steps of hypothesis testing<a class="anchor" aria-label="anchor" href="#steps-of-hypothesis-testing"></a>
</h3>
<p>Letâs recapitulate what happens during hypothesis testing. Ideally,
you undertake the following steps:</p>
<ol style="list-style-type: decimal">
<li>Set up a null model or null hypothesis<br>
</li>
<li>Collect data<br>
</li>
<li>Calculate the probability of the data in the null model<br>
</li>
<li>Decide: Reject the null model if the above probability is too
small.</li>
</ol>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</div></section><section id="aio-02-first-test"><p>Content from <a href="02-first-test.html">Our first test: Disease prevalence</a></p>
<hr>
<p> Last updated on 2023-05-03 | 
        
        <a href="https://github.com/carpentries/workbench-template-rmd/edit/main/episodes/02-first-test.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What is the null distribution?</li>
<li>How can we use the null distribution to make a decision in
hypothesis testing?<br>
</li>
<li>How can we run a hypothesis test in R?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Give an example for a simple hypothesis test, including setting up
the null and alternative hypothesis and the corresponding null model,
and decision making.<br>
</li>
<li>Demonstrate how p-values can be calculated from either cumulative
probabilities or the <code>.test</code> functions in R.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>Throughout the next episodes, we consider a research project where we
want to find out whether the prevalence of a disease in a test group is
different from the population average. Weâll conduct a very simple test
to answer that question.</p>
<figure><img src="fig/02-disease-prevalence.png" alt="" width="500" class="figure mx-auto d-block"><figcaption>Example: Disease prevalence</figcaption></figure><p>Suppose There is a disease with a known prevalence of 4%. This means,
4% of the whole population have this disease. Now you are interested in
whether a certain pre-condition, letâs say overweight, or living in a
certain area, changes the risk of getting the disease. You take 100
persons with this precondition and you check the disease prevalence
within the test group. 9 out of the 100 test persons have the
disease.</p>
<div class="section level3">
<h3 id="null-and-alternative-hypothesis">Null and alternative hypothesis<a class="anchor" aria-label="anchor" href="#null-and-alternative-hypothesis"></a>
</h3>
<p>This is how we can formalize the hypotheses: Our <strong>null
hypothesis</strong> is the âboringâ outcome. If there is nothing to see
in the data, then the prevalence in the test group is also 4%, just as
in the whole population. We want to collect evidence against this
hypothesis. If we have enough evidence against the null, we reject it,
and accept the alternative hypothesis that the prevalence in the test
group differs from 4%. This test is so easy, because the null model is
simply the well-known binomial distribution with a sample size of 100
and a probability of 4%:</p>
<p><span class="math display">\[ H_O: X \sim Bin(N=100,
p=0.04)\]</span></p>
</div>
<div class="section level3">
<h3 id="the-null-distribution">The null distribution<a class="anchor" aria-label="anchor" href="#the-null-distribution"></a>
</h3>
<p>We can look at this distribution:</p>
<figure><img src="fig/02-null-distribution.png" alt="binomial probability distribution of number of patients with disease" width="500" class="figure mx-auto d-block"><figcaption>The null distribution</figcaption></figure><p>It gives us the probabilities of seeing <span class="math inline">\(X\)</span> cases out of 100 with the disease,
given that each individual has a probability of 4% of having this
disease. This distribution peaks at 4 out of a 100, which makes sense:
You expect to see around 4 out of a 100 when the probability is 4%. We,
on the other hand, observed 9 out of a 100. Now we can ask: How likely
is it to see an event at least as extreme as 9 out of 100, assuming the
null hypothesis, and thus the distribution above, is true. In this case,
the probability of observing 9 or more persons with the disease is
0.019, this is rather unlikely, and we will conclude that the null
hypothesis is likely false.</p>
</div>
<div class="section level3">
<h3 id="decision-do-we-reject-the-null-hypothesis">Decision: Do we reject the null hypothesis?<a class="anchor" aria-label="anchor" href="#decision-do-we-reject-the-null-hypothesis"></a>
</h3>
<p>At what probability should you decide to reject the null hypothesis?
This choice is rather arbitrary. It depends on how sure you want to be
that there is really something to see in the data set. <strong>A
wide-spread convention is to call the result significant if the
probability under the null hypothesis is smaller than 5%.</strong> We
say that you choose a significance level alpha of <span class="math inline">\(\alpha=5 \%\)</span>. In our example, with a
significance level of 5%, all observations above 8 out of 100, shown in
red, would be called significant.</p>
<figure><img src="fig/02-significance.png" alt="The null distribution of the number of patients with disease, with significant outcomes indicated by colour." width="500" class="figure mx-auto d-block"><figcaption>The null distribution</figcaption></figure>
</div>
<div class="section level3">
<h3 id="recap">Recap<a class="anchor" aria-label="anchor" href="#recap"></a>
</h3>
<p>Here is what we have just seen:</p>
<ul>
<li>In a <strong>test group</strong> of persons with a precondition, 9
out of 100 have the disease of interest.<br>
</li>
<li>We compare to a <strong>known prevalence</strong> of 4%, that means
4% of the entire population have the disease, when not distinguishing
between persons with and without the precondition.<br>
</li>
<li>We want to know whether the observed 9 out of 100 are significantly
different from 4%. The <strong>null hypothesis</strong> thus is that
they are <em>not</em>.</li>
<li>The <strong>alternative hypothesis</strong> is that the prevalence
in the test group differs from 4%.<br>
</li>
<li>As we have 100 cases and a binary outcome (disease or no disease), a
suitable <strong>null model</strong> is a binomial distribution with
<span class="math inline">\(n=100\)</span> and success probability <span class="math inline">\(p=0.04\)</span>.</li>
</ul>
</div>
<div class="section level3">
<h3 id="binomial-test-in-r">Binomial test in R<a class="anchor" aria-label="anchor" href="#binomial-test-in-r"></a>
</h3>
<p>R is very convenient for calculating probabilities under different
distributions, and also has functions for the common statistical
tests.</p>
<p>As a reminder, functions in R that calculate numbers for the binomial
distribution all end with <code>binom</code>, and the prefix specifies
what to calculate:<br>
- <code>dbinom</code>: density<br>
- <code>pbinom</code>: cumulative distribution function (percentage of
values smaller than)</p>
<p>For example, you can calculate the probability of observing 5 persons
out of 100 with a disease, given a prevalence of 4%:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">=</span> <span class="fl">100</span> <span class="co"># number of test persons</span></span>
<span><span class="va">p</span> <span class="op">=</span> <span class="fl">0.04</span> <span class="co"># given prevalence</span></span>
<span><span class="fu">dbinom</span><span class="op">(</span>x<span class="op">=</span><span class="fl">5</span>, size<span class="op">=</span><span class="va">n</span>, prob<span class="op">=</span><span class="va">p</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.1595108</code></pre>
</div>
<div id="challenge-binomial-test" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-binomial-test" class="callout-inner">
<h3 class="callout-title">Challenge: Binomial test<a class="anchor" aria-label="anchor" href="#challenge-binomial-test"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li><p>Can you perform the test demonstrated above, using
<code>pbinom</code>? For this, you need to calculate the probability of
observing 9 or more persons with a disease out of 100, given a ânull
prevalenceâ of 4%.</p></li>
<li><p>Look up <code>binom.test</code>. This function performs a
binomial test â which is what you have just done manually by calculating
a binomial probability under a null hypothesis. Use this function to
perform the test. Do you get the same result as with
<code>pbinom</code>?</p></li>
</ol>
<p>You can look up the function as follows:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">help</span><span class="op">(</span><span class="va">binom.test</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<ol style="list-style-type: decimal">
<li>Calculate the probability as follows:</li>
</ol>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">pbinom</span><span class="op">(</span>q<span class="op">=</span><span class="fl">8</span>, size<span class="op">=</span><span class="fl">100</span>, prob<span class="op">=</span><span class="fl">0.04</span>, lower.tail<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.01899192</code></pre>
</div>
<p>Note: We use <code>q=8</code>, because if
<code>lower.tail=FALSE</code>, the probability <span class="math inline">\(P(X&gt;x)\)</span> is calculated. Check
<code>help(pbinom)</code> for this.</p>
<ol start="2" style="list-style-type: decimal">
<li>Using <code>binom.test</code>:</li>
</ol>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">binom.test</span><span class="op">(</span><span class="fl">9</span>,<span class="fl">100</span>,p<span class="op">=</span><span class="fl">0.04</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Exact binomial test

data:  9 and 100
number of successes = 9, number of trials = 100, p-value = 0.01899
alternative hypothesis: true probability of success is not equal to 0.04
95 percent confidence interval:
 0.0419836 0.1639823
sample estimates:
probability of success 
                  0.09 </code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="discussion1" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Discussion<a class="anchor" aria-label="anchor" href="#discussion1"></a>
</h3>
<div class="callout-content">
<p>Before we continue to the next episode, I have to tell you that
something is very wrong (conceptionally) with the test we just
performed.</p>
<figure><img src="fig/A_small_cup_of_coffee.JPG" alt="A cup of coffee" width="300" class="figure mx-auto d-block"><figcaption>Please take a minuteâ¦</figcaption></figure><p>â¦ and think about what the <em>initial alternative hypothesis</em>
was, and whether this is in line with what we calculated.</p>
<p>(Image: Wikimedia)</p>
</div>
</div>
</div>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</div></section><section id="aio-03-two-sided-test"><p>Content from <a href="03-two-sided-test.html">One-sided vs. two-sided tests, and data snooping</a></p>
<hr>
<p> Last updated on 2023-05-03 | 
        
        <a href="https://github.com/carpentries/workbench-template-rmd/edit/main/episodes/03-two-sided-test.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>Why is it important to define the hypothesis <em>before</em> running
the test?</li>
<li>What is the difference between one-sided and two-sided tests?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain the difference between one-sided and two-sided tests</li>
<li>Raise awareness of data snooping / HARKing</li>
<li>Introduce further arguments in the <code>binom.test</code>
function</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="a-one-sided-test"><h2 class="section-heading">A one-sided test<a class="anchor" aria-label="anchor" href="#a-one-sided-test"></a>
</h2>
<hr class="half-width">
<figure><img src="fig/02-significance.png" alt="Binomial null distribution with one-sided significance indicated." width="500" class="figure mx-auto d-block"><figcaption>One-sided test</figcaption></figure><p>What youâve seen in the last episode was a <strong>one-sided
test</strong>, which means we looked at only at one side of the
distribution. In this example, we observed 9 out of 100 persons with
disease, then we asked: What is the probability under the null, to
observe at least 9 persons with that disease. And we rejected all the
outcomes where this probability was lower than 5%. The alternative
hypothesis that we then take on is that the prevalence is larger than
4%. But we could just as well have looked in the other direction and
have asked: What is the probability of seeing at most the observed
number of diseased under the null, and then in case of rejecting the
null, weâd have accept the alternative hypothesis that the prevalence is
below 4%.</p>
<p>Let me remind you how we initially phrased the research question and
the alternative hypothesis: We wanted to test whether the prevalence is
different from 4%. Well, different can be smaller or larger. So, to be
fair, this is what we should actually do:</p>
<p><img src="fig/03-two-sided-significance.png" alt="Binomial null distribution with two-sided significance indicated." width="500" class="figure"> We should look on both sides of the distribution and ask
what outcomes are unlikely. For this, we split the 5% significance to
2.5% on each side. That way, we will reject everything below 1, or above
8. The alternative hypothesis is now that the prevalence is different
from 4%.</p>
<p>But what exactly was wrong with a one-sided test? An observation of 9
is clearly higher than the expected 4, so no need to test on the other
side, right? Unfortunately: no.</p>
<div class="section level3">
<h3 id="excursion-data-snooping-harking">Excursion: Data snooping / HARKing<a class="anchor" aria-label="anchor" href="#excursion-data-snooping-harking"></a>
</h3>
<p>What we did is called <strong>HARKing</strong>, which stands for
âhypothesis after results knownâ, or, also data snooping.<br>
The problem is, we decided on the direction to look at after having seen
at the data, and <strong>this messes with the significance level <span class="math inline">\(\alpha\)</span></strong>. The 5% is just not true
anymore, because we spent all the 5% on one side, and we cheated by
looking into the data to decide which side we want to look at. But if
the null were true, then there would be a (roughly) 50:50 chance that
the test group gives you an outcome that is higher or lower than the
expected value. So weâd have to double the alpha, and in reality it
would be around 10%. This means, assuming the null was true, we actually
had an about 10% chance of falsely rejecting it.</p>
<div id="side-note" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="side-note" class="callout-inner">
<h3 class="callout-title">Side note<a class="anchor" aria-label="anchor" href="#side-note"></a>
</h3>
<div class="callout-content">
<p>Above it says that there is a ~50% chance of the observation being
below 4, and that a one-sided test after looking into the data had a
significance level of ~0.1. The numbers are approximate, because a
binomial distribution has discrete numbers. This means that</p>
<ol style="list-style-type: decimal">
<li>thereâs not actually an outcome where the probability of seeing an
outcome as high as this or higher is <em>exactly</em> 5%.<br>
</li>
<li>itâs actually more likely to see an outcome below 4 (<span class="math inline">\(p=0.43\)</span>), than seeing an outcome above
(<span class="math inline">\(p=0.37\)</span>). The numbers donât add up
to 1, because there is also the option of observing exactly 4 (<span class="math inline">\(p=0.2\)</span>).</li>
</ol>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="one-sided-and-two-sided-tests-in-r">One-sided and two-sided tests in R<a class="anchor" aria-label="anchor" href="#one-sided-and-two-sided-tests-in-r"></a>
</h3>
<p>Many tests in R have the argument <code>alternative</code>, which
allows you to choose the alternative hypothesis to be
<code>two.sided</code>, <code>greater</code>, or <code>less</code>. If
you donât specify this argument, it defaults to <code>two.sided</code>.
So it turns out, in the exercise above, you did the right thing
with:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">binom.test</span><span class="op">(</span><span class="fl">9</span>,<span class="fl">100</span>,p<span class="op">=</span><span class="fl">0.04</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Exact binomial test

data:  9 and 100
number of successes = 9, number of trials = 100, p-value = 0.01899
alternative hypothesis: true probability of success is not equal to 0.04
95 percent confidence interval:
 0.0419836 0.1639823
sample estimates:
probability of success 
                  0.09 </code></pre>
</div>
<p>A one-sided test would be:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">binom.test</span><span class="op">(</span><span class="fl">9</span>,<span class="fl">100</span>, p<span class="op">=</span><span class="fl">0.04</span>, alternative<span class="op">=</span><span class="st">"greater"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Exact binomial test

data:  9 and 100
number of successes = 9, number of trials = 100, p-value = 0.01899
alternative hypothesis: true probability of success is greater than 0.04
95 percent confidence interval:
 0.04775664 1.00000000
sample estimates:
probability of success 
                  0.09 </code></pre>
</div>
<p>Itâs a little bit confusing that both tests give a similar p-value
here, which is again due to the distributionâs discreteness. Using
different numbers will show how the p-value for the same observation is
lower if you choose a one-sided test:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">binom.test</span><span class="op">(</span><span class="fl">27</span>, <span class="fl">100</span>, p<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.102745</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">binom.test</span><span class="op">(</span><span class="fl">27</span>, <span class="fl">100</span>, p<span class="op">=</span><span class="fl">0.2</span>, alternative<span class="op">=</span><span class="st">"greater"</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.05583272</code></pre>
</div>
<div id="challenge-one-sided-test" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-one-sided-test" class="callout-inner">
<h3 class="callout-title">Challenge: one-sided test<a class="anchor" aria-label="anchor" href="#challenge-one-sided-test"></a>
</h3>
<div class="callout-content">
<p>In which of these cases would a one-sided test be OK?</p>
<ol style="list-style-type: decimal">
<li>The trial was conducted to find out whether the disease prevalence
is increased due to the precondition. In case of a significant outcome,
persons with the preconditions would be monitored more carefully by
their doctors.<br>
</li>
<li>You want to find out whether new-born children already resemble
their father. Study participants look at a photo of a baby, and two
photos of adult men, one of which is the father. They have to guess
which of them. The hypothesis is that new-borns resemble their fathers
and the father is thus guessed &gt;50% of the cases. There is no reason
to believe that children resemble their fathers <em>less</em> than they
resemble randomly chosen men.</li>
<li>When looking at the data (only 1 out of 100), it becomes clear that
the prevalence is certainly not increased by the precondition. It might
even <em>decrease</em> the risk. We thus test for that.</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>In the first and second scenario, one-sided tests could be used.
There are different opinions to how sparsely they should be used. For
example, <a href="https://whitlockschluter.zoology.ubc.ca/" class="external-link">Whitlock and
Schluter</a> gave the second scenario as a potential use-case. They
believe that a one-sided test should only be used if âthe null
hypothesis are inconceivable for any reason other than chanceâ. They
would likely argue against using a one-sided test in the first scenario,
because what if the disease prevalence is decreased due to the
precondition? Wouldnât we find this interesting as well?</p>
</div>
</div>
</div>
</div>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</div>
</section></section><section id="aio-04-errors-in-hypothesis-testing"><p>Content from <a href="04-errors-in-hypothesis-testing.html">Errors in hypothesis testing</a></p>
<hr>
<p> Last updated on 2023-05-03 | 
        
        <a href="https://github.com/carpentries/workbench-template-rmd/edit/main/episodes/04-errors-in-hypothesis-testing.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What errors can occur in hypothesis testing?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>List the possible errors in hypothesis testing and give the reasons
why they occur.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>We just learned about data snooping, or HARKing, which is one way of
<em>p-hacking</em>, i.e.Â cheating to get significant results. Another
example is method hacking, where you try different methods until one of
them gives a significant result.</p>
<p>You might have heard people say that p-hacking (or other things)
<em>increase type I error</em>. Hereâs what this means:</p>
<p>If you perform a test and either reject the null hypothesis or not,
there are four possible outcomes:</p>
<figure><img src="fig/04-errors_hypothesis_testing.png" alt="image of confusion matrix" width="600" class="figure mx-auto d-block"><figcaption>Errors in hypothesis testing</figcaption></figure><ul>
<li>The favorable classifications are <strong>true negative</strong>,
where you correctly donât reject the null, and <strong>true
positive</strong>, where you correctly reject it and decide that there
is something interesting to see in your data.<br>
</li>
<li>There are also two ways in which the classification can go wrong.
One is said <strong>false positive</strong>, also called <strong>type I
error</strong>, where the null is incorrectly rejected. This just
happens by chance in a certain percentage of cases. For example, per
definition it happens in 5% of the cases when you choose a significance
level of <span class="math inline">\(\alpha=0.05\)</span>. But there are
other things that can increase the chances for false positives,
including p-hacking, multiple comparisons (which is part of the next
tutorial), or certain violations of the assumptions
(e.g.Â independence).<br>
</li>
<li>
<strong>False negative</strong> classification or <strong>type
II</strong> error describes the case when the null hypothesis isnât
rejected even though something interesting is happening. This is likely
to happen if we have too little data, or use methods that are not
powerful enough to detect what weâre looking for. We try to avoid type
II error by choosing methods with a <em>high power</em>.</li>
</ul></section><section id="aio-05-one-sample-t-test"><p>Content from <a href="05-one-sample-t-test.html">One-sample t-test</a></p>
<hr>
<p> Last updated on 2023-05-03 | 
        
        <a href="https://github.com/carpentries/workbench-template-rmd/edit/main/episodes/05-one-sample-t-test.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What is a one-sample t-test?</li>
<li>Why is <span class="math inline">\(t\)</span> a useful test
statistic?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Give an example for the one-sample t-test.</li>
<li>Explain null and alternative hypothesis, and why we use test
statistics.</li>
<li>Explain that <span class="math inline">\(t\)</span> weighs sample
size and effect size against variance.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>Letâs get back to the mice example we saw in the beginning. Weâll
first simplify the example a bit: Letâs suppose you measure the weight
of a couple of mice that have been fed with high-fat diet (black dots).
We now want to know whether the mice weights in the test group differ
significantly from a known average mouse weight (blue line).</p>
<figure><img src="fig/05-mouse-weights.png" alt="graph showing mouse weights of one sample, and a mean to compare them to." width="500" class="figure mx-auto d-block"><figcaption>Scenario for one-sided t-test: Comparing mouse
weights to a single value.</figcaption></figure><p>In the graph above you see one sample of 20 mice weights, from mice
that had special diet, which average to <span class="math inline">\(\bar{x}=26.6\,g\)</span>. We will compare their
weights to a known average mouse weight <span class="math inline">\(mu_0=23.9\,g\)</span>. That means, we
<strong>compare a sample mean to <span class="math inline">\(mu_0\)</span></strong>.</p>
<div class="section level3">
<h3 id="road-map-for-the-next-three-episodes">Road map for the next three episodes<a class="anchor" aria-label="anchor" href="#road-map-for-the-next-three-episodes"></a>
</h3>
<p>In this example, I will explain a t-test, one of the most commonly
used tests. It is used for comparing two groups, or for comparing one
groupâs average to a known average. I use the example to demonstrate the
steps of performing a test that are valid for every test:</p>
<ul>
<li>Set up the null hypothesis (and the alternative). In this case, that
the mice in the test group (black dots) weigh on average the same as the
known average weight (blue line).<br>
</li>
<li>Come up with a <strong>test statistic</strong>, that is, a number
that summarizes the data points in a useful way. In the t-test, this
statistic is called <span class="math inline">\(t\)</span>.<br>
</li>
<li>Calculate value for the statistic (<span class="math inline">\(t\)</span>) for the given data.<br>
</li>
<li>Calculate how likely it is to observe this value by chance, if the
null hypothesis is true. For the t-test, this means calculating the
probability of <span class="math inline">\(t\)</span> under the
t-distribution. I will give you two explanations for why the
t-distribution is a useful distribution for this example.<br>
</li>
<li>The calculated probability is the <strong>p-value</strong>, from
which we can decide whether or not to reject the null hypothesis.</li>
</ul>
</div>
<div class="section level3">
<h3 id="null-and-alternative-hypothesis">Null and alternative hypothesis<a class="anchor" aria-label="anchor" href="#null-and-alternative-hypothesis"></a>
</h3>
<p><strong>Null hypothesis:</strong> Mice fed with special diet are no
different from other mice, and the observed difference between sample
mean and mu0 was just by chance.<br><strong>Alternative hypothesis</strong>: The diet makes a difference,
and the sampled mice come from a population where the average weight
differs from <span class="math inline">\(mu_0\)</span>.</p>
</div>
<div class="section level3">
<h3 id="the-t-statistic">The t-statistic<a class="anchor" aria-label="anchor" href="#the-t-statistic"></a>
</h3>
<p>In the previous example, we had measured one number, namely 9 persons
with disease, of which we could calculate the probability under the
null. This is not the case here: Here we have 20 numbers. Therefore, we
have to help ourselves by summarizing these 20 numbers into something
meaningful.</p>
<p>Hereâs what we calculate:</p>
<figure><img src="fig/05-t-statistic.png" alt="Formula for t-statistic, and graph with moise weights indicating sample mean and mu0" width="600" class="figure mx-auto d-block"><figcaption>The t-statistic is a scaled difference between sample
mean and <span class="math inline">\(\mu_0\)</span></figcaption></figure><p>The t- statistic is one value made out of the 20 values in the sample
â a scaled sample mean. In the numerator, we have the difference between
<span class="math inline">\(\bar{x}\)</span>, the sample mean, and <span class="math inline">\(\mu_0\)</span>. The denominator is the standard
error of the mean (SEM), which is the sample standard deviation over the
square root of the sample size.</p>
<p>Why is this a useful summary of the data? Because <span class="math inline">\(t\)</span> <strong>summarizes how much evidence we
have against the null hypothesis</strong>. This means, <span class="math inline">\(t\)</span> is close to 0 if there is little
evidence, and it becomes large when we have a lot of evidence.</p>
<figure><img src="fig/05-scale.png" alt="Formula for t-statistic, and image of scale" width="600" class="figure mx-auto d-block"><figcaption>The t-statistic weighs effect size and sample size
against variance.</figcaption></figure><p>In other words, we can say that <strong><span class="math inline">\(t\)</span> weighs effect size and sample size
against the variance.</strong></p>
<p>Evidence for a true difference between the weight of high-fat diet
mice and <span class="math inline">\(\mu_0\)</span> increases (the
absolute value of) <span class="math inline">\(t\)</span>:</p>
<ul>
<li>
<span class="math inline">\(\bar{x}-\mu_0\)</span> is the observed
difference between sample mean and <span class="math inline">\(\mu_0\)</span>. If this difference is increased,
then <span class="math inline">\(t\)</span> is increased also.<br>
</li>
<li>
<span class="math inline">\(\hat{\sigma}\)</span> is the sample
standard deviation (and in the denominator). If the sample has a high
variance, this decreases the evidence â and <span class="math inline">\(t\)</span>.<br>
</li>
<li>
<span class="math inline">\(n\)</span> is the sample size.
Increasing <span class="math inline">\(n\)</span> also increases <span class="math inline">\(t\)</span>, since more data points mean more
evidence.</li>
</ul>
<p>Keep this picture in mind, because this weighing of effect size,
sample size, and variance, is essentially what every test does, not only
the t-test. Itâs just the calculation, or the statistic used, that
depends on the type of data.</p>
</div>
<div class="section level3">
<h3 id="performing-the-t-test">Performing the t-test<a class="anchor" aria-label="anchor" href="#performing-the-t-test"></a>
</h3>
<figure><img src="fig/05-performing-t-test.png" alt="Schema for performing a one-sample t-test" width="800" class="figure mx-auto d-block"><figcaption>One-sample t-test</figcaption></figure><p>Back to our example: From the data, we can calculate the test
statistic <span class="math inline">\(t\)</span>, which in this case is
<span class="math inline">\(t=2.57\)</span>. All thatâs left to do is to
look up whether a value as large as <span class="math inline">\(2.57\)</span> is surprising or not under the null
distribution, which for the t-test is the t-distribution. The null
distribution allows us to calculate how likely it is to observe a <span class="math inline">\(t\)</span> with an absolute value as large or
larger than <span class="math inline">\(2.57\)</span>, assuming that the
data mean is <span class="math inline">\(mu_0=23.9\)</span>. This
probability under the null is <span class="math inline">\(p=0.019\)</span> for the given data. This means we
can reject the null at a 5% significance level. We conclude that the
data mean is different from <span class="math inline">\(mu_0\)</span>,
and that the mice on the special diet have a different weight from the
known average. In the next section, you will learn what the
t-distribution is and why it is a good distribution for <span class="math inline">\(t\)</span>.</p>
<div id="calculate-t" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="calculate-t" class="callout-inner">
<h3 class="callout-title">Calculate t<a class="anchor" aria-label="anchor" href="#calculate-t"></a>
</h3>
<div class="callout-content">
<p>Do the first step of your own t-test! Below, the values I used for
the above graph are summarized in the <code>weights</code> vector.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weights</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">31.41</span>, <span class="fl">28.29</span>, <span class="fl">22.82</span>, <span class="fl">26.07</span>, <span class="fl">31.97</span>, <span class="fl">22.60</span>, <span class="fl">31.47</span>, <span class="fl">29.18</span>, <span class="fl">22.98</span>, <span class="fl">23.26</span>, <span class="fl">23.48</span>, <span class="fl">20.88</span>, <span class="fl">28.44</span>, <span class="fl">30.34</span>, <span class="fl">23.14</span>, <span class="fl">22.80</span>, <span class="fl">24.47</span>, <span class="fl">39.73</span>, <span class="fl">25.71</span>, <span class="fl">22.74</span><span class="op">)</span></span>
<span><span class="va">mu0</span> <span class="op">&lt;-</span> <span class="fl">23.89338</span></span></code></pre>
</div>
<ol style="list-style-type: decimal">
<li>Calculate <span class="math inline">\(t\)</span>
</li>
<li>Add an outlier with a weight of <span class="math inline">\(50\)</span> to the <code>weights</code> vector.
How does this affect <span class="math inline">\(t\)</span>?</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<ol style="list-style-type: decimal">
<li>Calculate t:</li>
</ol>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tstat</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu">mean</span><span class="op">(</span><span class="va">weights</span><span class="op">)</span> <span class="op">-</span> <span class="va">mu0</span><span class="op">)</span> <span class="op">*</span><span class="fu">sqrt</span><span class="op">(</span><span class="fu">length</span><span class="op">(</span><span class="va">weights</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu">sd</span><span class="op">(</span><span class="va">weights</span><span class="op">)</span> </span>
<span><span class="va">tstat</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 2.567434</code></pre>
</div>
<ol start="2" style="list-style-type: decimal">
<li>Add an outlier</li>
</ol>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weights</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="va">weights</span>,<span class="fl">50</span><span class="op">)</span></span>
<span><span class="va">tstat</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu">mean</span><span class="op">(</span><span class="va">weights</span><span class="op">)</span> <span class="op">-</span> <span class="va">mu0</span><span class="op">)</span> <span class="op">*</span><span class="fu">sqrt</span><span class="op">(</span><span class="fu">length</span><span class="op">(</span><span class="va">weights</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu">sd</span><span class="op">(</span><span class="va">weights</span><span class="op">)</span> </span>
<span><span class="va">tstat</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 2.545858</code></pre>
</div>
</div>
</div>
</div>
</div>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</div></section><section id="aio-06-CLT"><p>Content from <a href="06-CLT.html">The distribution of t according to the Central Limit Theorem</a></p>
<hr>
<p> Last updated on 2023-05-03 | 
        
        <a href="https://github.com/carpentries/workbench-template-rmd/edit/main/episodes/06-CLT.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What is the central limit theorem?</li>
<li>What does it predict for the distribution of <span class="math inline">\(t\)</span>?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Introduce the Central limit theorem.</li>
<li>Explain that it gives a theoretical distribution for <span class="math inline">\(t\)</span>.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="calculate-a-p-value-using-the-central-limit-theorem">Calculate a p-value using the central limit theorem<a class="anchor" aria-label="anchor" href="#calculate-a-p-value-using-the-central-limit-theorem"></a>
</h3>
<p>Let me sum up what we know now:</p>
<ul>
<li>We have a sample of mice weights and a weight <span class="math inline">\(\mu_0\)</span> that we compare these weights to.
We want to know whether the average weight differs from <span class="math inline">\(\mu_0\)</span>.<br>
</li>
<li>We calculated <span class="math inline">\(t\)</span> for this
specific sample. <span class="math inline">\(t\)</span> is a scaled
difference between sample mean and <span class="math inline">\(\mu_0\)</span>. In case the sample mean is the
same as <span class="math inline">\(\mu_0\)</span>, <span class="math inline">\(t\)</span> should be close to zero.<br>
</li>
<li>Moreover, the central limit theorem tells us that, if high fat diet
mice in general donât differ from <span class="math inline">\(\mu_0\)</span> in their weight, we can expect
<span class="math inline">\(t\)</span> to come from a standard normal
distribution.</li>
</ul>
<p>This means, that if we sample again and again (i.e.Â the experiment
where 20 mice were fed with special diet and weighed, and a <span class="math inline">\(t\)</span> was calculated), we should measure a
different <span class="math inline">\(t\)</span> each time, and plotting
the a histogram or density of <span class="math inline">\(t\)</span>s
will give a Gaussian bell shape.<br>
This is enough knowledge to calculate a p-value. You can do this :)</p>
<div id="the-distribution-of-t" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="the-distribution-of-t" class="callout-inner">
<h3 class="callout-title">The distribution of t<a class="anchor" aria-label="anchor" href="#the-distribution-of-t"></a>
</h3>
<div class="callout-content">
<p>We start with the mouse weights and the resulting <span class="math inline">\(t\)</span> from the last section.</p>
<ol style="list-style-type: decimal">
<li><p>What is the probability of observing a <span class="math inline">\(t\)</span> with value at least as high as that
seen here in a standard normal distribution (normal distribution with
mean 0 and standard deviation of 1)?</p></li>
<li><p>Remember that in this scenario the question is not whether the
weight is âhigher thanâ, but âdifferent fromâ <span class="math inline">\(\mu_0\)</span>. How do you have to adapt the above
calculation to make this a two-sided test?</p></li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<ol style="list-style-type: decimal"><li>
</li></ol>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weights</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">31.41</span>, <span class="fl">28.29</span>, <span class="fl">22.82</span>, <span class="fl">26.07</span>, <span class="fl">31.97</span>, <span class="fl">22.60</span>, <span class="fl">31.47</span>, <span class="fl">29.18</span>, <span class="fl">22.98</span>, <span class="fl">23.26</span>, <span class="fl">23.48</span>, <span class="fl">20.88</span>, <span class="fl">28.44</span>, <span class="fl">30.34</span>, <span class="fl">23.14</span>, <span class="fl">22.80</span>, <span class="fl">24.47</span>, <span class="fl">39.73</span>, <span class="fl">25.71</span>, <span class="fl">22.74</span><span class="op">)</span></span>
<span><span class="va">mu0</span> <span class="op">&lt;-</span> <span class="fl">23.89338</span></span>
<span><span class="va">tstat</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu">mean</span><span class="op">(</span><span class="va">weights</span><span class="op">)</span> <span class="op">-</span> <span class="va">mu0</span><span class="op">)</span> <span class="op">*</span><span class="fu">sqrt</span><span class="op">(</span><span class="fu">length</span><span class="op">(</span><span class="va">weights</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu">sd</span><span class="op">(</span><span class="va">weights</span><span class="op">)</span> </span>
<span><span class="fu">pnorm</span><span class="op">(</span><span class="va">tstat</span>, mean<span class="op">=</span><span class="fl">0</span>, sd<span class="op">=</span><span class="fl">1</span>,lower.tail<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.005122719</code></pre>
</div>
<ol start="2" style="list-style-type: decimal">
<li>Just multiply by 2: that gives the probability to get something
larger than the observed t, or smaller than -t. Multiplying works,
because the normal distribution is symmetric.</li>
</ol>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">pnorm</span><span class="op">(</span><span class="va">tstat</span>, mean<span class="op">=</span><span class="fl">0</span>, sd<span class="op">=</span><span class="fl">1</span>,lower.tail<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">*</span><span class="fl">2</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.01024544</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="congrats">Congratsâ¦<a class="anchor" aria-label="anchor" href="#congrats"></a>
</h3>
<p>â¦the worst part is over! If you could follow until here, you
understood the essence of the t-test. Everything that follows is just
practical details.</p>
<figure><img src="fig/celebrate_pngwing.com.png" alt="picture of fireworks" width="800" class="figure mx-auto d-block"></figure><!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</div></section><section id="aio-07-t-practice"><p>Content from <a href="07-t-practice.html">The distribution of t in practice</a></p>
<hr>
<p> Last updated on 2023-05-09 | 
        
        <a href="https://github.com/carpentries/workbench-template-rmd/edit/main/episodes/07-t-practice.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>Is the t-statistic normally distributed?</li>
<li>What is the t-distribution?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Introduce the t-distribution and why itâs useful for small
samples.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>The big question is: Is the central limit theorem valid for this
example? After all, it says something like âif we have enough data
pointsââ¦ do we have enough data points?</p>
<p>The following code snipped will read a file with mice weights from a
URL, and apply some transformations on it. If you run this, you will
have a vector called <code>population</code> with 841 mice
measurements.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mice_pheno</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span>file<span class="op">=</span> <span class="fu">url</span><span class="op">(</span><span class="st">"https://raw.githubusercontent.com/genomicsclass/dagdata/master/inst/extdata/mice_pheno.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mice_pheno</span> <span class="op">&lt;-</span> <span class="fu">filter</span><span class="op">(</span><span class="va">mice_pheno</span>, <span class="op">!</span><span class="fu">is.na</span><span class="op">(</span><span class="va">Bodyweight</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">population</span> <span class="op">&lt;-</span> <span class="va">mice_pheno</span><span class="op">$</span><span class="va">Bodyweight</span></span></code></pre>
</div>
<p>We will assume that those 841 measurements constitute the population
of mice.<br>
We can calculate the the population average and use it as <span class="math inline">\(\mu_0\)</span>.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mu0</span> <span class="op">&lt;-</span> <span class="fu">mean</span><span class="op">(</span><span class="va">population</span><span class="op">)</span></span></code></pre>
</div>
<p>Now we draw a sample of 20 mice again and again, and calculate the
statistic <span class="math inline">\(t\)</span> each time. This way, we
have a scenario where the null hypothesis is true (the population
average doesnât differ from <span class="math inline">\(\mu_0\)</span>)
and we can check how <span class="math inline">\(t\)</span> behaves.</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set a seed for reproducibility</span></span>
<span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">21</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># choose sample size</span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span></span>
<span><span class="co"># initialize vector for a loop,</span></span>
<span><span class="co"># we will sample 10000 times</span></span>
<span><span class="va">null_t</span> <span class="op">&lt;-</span> <span class="fu">rep</span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">10000</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu">seq_along</span><span class="op">(</span><span class="va">null_t</span><span class="op">)</span><span class="op">)</span><span class="op">{</span> <span class="co"># loop for sampling 10000 times</span></span>
<span>  <span class="va">null_sample</span> <span class="op">&lt;-</span> <span class="fu">sample</span><span class="op">(</span><span class="va">population</span>, <span class="va">N</span><span class="op">)</span> <span class="co"># draw a sample from the population</span></span>
<span>  <span class="va">se</span> <span class="op">&lt;-</span> <span class="fu">sqrt</span><span class="op">(</span><span class="fu">var</span><span class="op">(</span><span class="va">null_sample</span><span class="op">)</span><span class="op">/</span><span class="va">N</span><span class="op">)</span> <span class="co"># calculate the standard error</span></span>
<span>  <span class="va">null_t</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu">mean</span><span class="op">(</span><span class="va">null_sample</span><span class="op">)</span><span class="op">-</span><span class="va">mu0</span><span class="op">)</span> <span class="op">/</span> <span class="va">se</span> <span class="co"># calculate t</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
<div id="plot-the-distribution-of-t" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="plot-the-distribution-of-t" class="callout-inner">
<h3 class="callout-title">Plot the distribution of t<a class="anchor" aria-label="anchor" href="#plot-the-distribution-of-t"></a>
</h3>
<div class="callout-content">
<p>Now itâs your turn to plot the distribution: Run the above code to
obtain the vector <code>null_t</code>.</p>
<ol style="list-style-type: decimal">
<li>Make a histogram out of <code>null_t</code>. Does it look like a
standard normal distribution?</li>
</ol>
<p>Hint: For plotting, it helps to turn your vector into a data
frame:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">t =</span> null_t) <span class="sc">%&gt;%</span> </span></code></pre>
</div>
<ol start="2" style="list-style-type: decimal">
<li>Try a QQ-plot instead.</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<ol style="list-style-type: decimal">
<li>The histogram is not very suspicious.</li>
</ol>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">data.frame</span><span class="op">(</span>t <span class="op">=</span> <span class="va">null_t</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">t</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<figure><img src="fig/07-t-practice-rendered-histogram-t-null-solution-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><ol start="2" style="list-style-type: decimal">
<li>The qq-plot</li>
</ol>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">data.frame</span><span class="op">(</span>t <span class="op">=</span> <span class="va">null_t</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>sample<span class="op">=</span><span class="va">t</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">stat_qq</span><span class="op">(</span><span class="op">)</span><span class="op">+</span> <span class="fu">stat_qq_line</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/07-t-practice-rendered-qq-t-null-solution-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
<p>You may notice that in general, around 0 the distribution looks like
a normal distribution. But at low and high values (called: the tails)
the distribution of <code>null_t</code> doesnât behave like a normal
distribution. This becomes more obvious in the QQ-plot, where the points
donât match the line at the sides.</p>
<p>Feel free to play with the sample size <code>N</code> in the below
code chunk, to see how the distribution of <span class="math inline">\(t\)</span> changes with the sample size:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># choose sample size</span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span></span>
<span><span class="co"># initialize vector for a loop,</span></span>
<span><span class="co"># we will sample 10000 times</span></span>
<span><span class="va">null_t</span> <span class="op">&lt;-</span> <span class="fu">rep</span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">10000</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu">seq_along</span><span class="op">(</span><span class="va">null_t</span><span class="op">)</span><span class="op">)</span><span class="op">{</span> <span class="co"># this is the loop in which we sample</span></span>
<span>  <span class="va">null_sample</span> <span class="op">&lt;-</span> <span class="fu">sample</span><span class="op">(</span><span class="va">population</span>, <span class="va">N</span><span class="op">)</span> <span class="co"># draw a sample from the population</span></span>
<span>  <span class="va">se</span> <span class="op">&lt;-</span> <span class="fu">sqrt</span><span class="op">(</span><span class="fu">var</span><span class="op">(</span><span class="va">null_sample</span><span class="op">)</span><span class="op">/</span><span class="va">N</span><span class="op">)</span> <span class="co"># calculate the standard error</span></span>
<span>  <span class="va">null_t</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu">mean</span><span class="op">(</span><span class="va">null_sample</span><span class="op">)</span><span class="op">-</span><span class="va">mu0</span><span class="op">)</span> <span class="op">/</span> <span class="va">se</span> <span class="co"># calculate t</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">data.frame</span><span class="op">(</span><span class="va">null_t</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>sample<span class="op">=</span><span class="va">null_t</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">stat_qq</span><span class="op">(</span><span class="op">)</span><span class="op">+</span> <span class="fu">stat_qq_line</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/07-t-practice-rendered-change-N-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div class="section level3">
<h3 id="the-t-distribution">The t-distribution<a class="anchor" aria-label="anchor" href="#the-t-distribution"></a>
</h3>
<p>We have seen that for small sample sizes, the central limit theorem
doesnât hold, and the values of <span class="math inline">\(t\)</span>
that we calculate from the data, donât follow a normal distribution.</p>
<p>The distribution of <span class="math inline">\(t\)</span>s looks
perfectly normal âin the middleâ, but not at the <em>tails</em>: We say
that the distribution has <em>heavy tails</em>, because <span class="math inline">\(t\)</span> tends to take extreme values (extremely
small or extremely large) more often than we would expect from a normal
distribution.</p>
<p>The good news is, we can still run a test on small samples, by using
the <em><span class="math inline">\(t\)</span>-distribution</em> as a
null distribution for <span class="math inline">\(t\)</span>. This
distribution looks like the normal distribution, but with heavy tails.
It has one parameter, <span class="math inline">\(\nu\)</span>, which
specifies the degrees of freedom. Without going into detail, <span class="math inline">\(\nu\)</span> is closely connected to the number of
data points (for a one-sample t-test, <span class="math inline">\(\nu=N-1\)</span>). In the figure below, you see
how the t-distribution changes with the sample size:</p>
<figure><img src="fig/Student_t_pdf.svg" alt="Graph showing t-distribution" width="500" class="figure mx-auto d-block"><figcaption>The t distribution for different degrees of freedom
(wikipedia)</figcaption></figure><p>For large samples, i.e.Â high values of <span class="math inline">\(\nu\)</span>, the heavy tails vanish and the
t-distribution becomes more and more similar to a normal distribution,
which is exactly what the central limit theorem tells us.</p>
<p><strong>Summary:</strong> We can use the t-distribution as a null
distribution for <span class="math inline">\(t\)</span>, without
worrying about the sample size.</p>
<div id="t-test-in-r" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="t-test-in-r" class="callout-inner">
<h3 class="callout-title">T-test in R<a class="anchor" aria-label="anchor" href="#t-test-in-r"></a>
</h3>
<div class="callout-content">
<p>For our example, you already calculated <span class="math inline">\(t=2.57\)</span> from the data for the mice on
diet, and the probability of <span class="math inline">\(t\)</span>
under the standard normal distribution. As a reminder:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">t_stat</span> <span class="op">&lt;-</span> <span class="fl">2.567434</span></span>
<span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="fu">pnorm</span><span class="op">(</span><span class="va">t_stat</span>, mean<span class="op">=</span><span class="fl">0</span>, sd<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="fl">2</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.01024543</code></pre>
</div>
<ol style="list-style-type: decimal">
<li>Get a p-value by calculating the probability of <span class="math inline">\(t\)</span> under the t-distribution. You will need
to specify the degrees of freedom, which is <span class="math inline">\(N-1\)</span> for a one-sample t-test.</li>
</ol>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">t_stat</span> <span class="op">&lt;-</span> <span class="fl">2.567434</span> <span class="co"># this is the value for t</span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">20</span> <span class="co"># the sample had 20 data points</span></span></code></pre>
</div>
<ol start="2" style="list-style-type: decimal">
<li>Try the function <code>t.test</code> to calculate the p-value:</li>
</ol>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weights</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">31.41</span>, <span class="fl">28.29</span>, <span class="fl">22.82</span>, <span class="fl">26.07</span>, <span class="fl">31.97</span>, <span class="fl">22.60</span>, <span class="fl">31.47</span>, <span class="fl">29.18</span>, <span class="fl">22.98</span>, <span class="fl">23.26</span>, <span class="fl">23.48</span>, <span class="fl">20.88</span>, <span class="fl">28.44</span>, <span class="fl">30.34</span>, <span class="fl">23.14</span>, <span class="fl">22.80</span>, <span class="fl">24.47</span>, <span class="fl">39.73</span>, <span class="fl">25.71</span>, <span class="fl">22.74</span><span class="op">)</span></span>
<span><span class="va">mu0</span> <span class="op">&lt;-</span> <span class="fl">23.89338</span></span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<ol style="list-style-type: decimal">
<li>Calculating the p-value using the t-distribution:</li>
</ol>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">t_stat</span> <span class="op">&lt;-</span> <span class="fl">2.567434</span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="fu">pt</span><span class="op">(</span><span class="va">t_stat</span>,df<span class="op">=</span><span class="va">N</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="fl">2</span></span></code></pre>
</div>
<ol start="2" style="list-style-type: decimal">
<li>Using <code>t.test</code>
</li>
</ol>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weights</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">31.41</span>, <span class="fl">28.29</span>, <span class="fl">22.82</span>, <span class="fl">26.07</span>, <span class="fl">31.97</span>, <span class="fl">22.60</span>, <span class="fl">31.47</span>, <span class="fl">29.18</span>, <span class="fl">22.98</span>, <span class="fl">23.26</span>, <span class="fl">23.48</span>, <span class="fl">20.88</span>, <span class="fl">28.44</span>, <span class="fl">30.34</span>, <span class="fl">23.14</span>, <span class="fl">22.80</span>, <span class="fl">24.47</span>, <span class="fl">39.73</span>, <span class="fl">25.71</span>, <span class="fl">22.74</span><span class="op">)</span></span>
<span><span class="va">mu0</span> <span class="op">&lt;-</span> <span class="fl">23.89338</span></span>
<span></span>
<span><span class="fu">t.test</span><span class="op">(</span><span class="va">weights</span>, mu <span class="op">=</span> <span class="va">mu0</span><span class="op">)</span></span></code></pre>
</div>
<p>The latter two outcomes should match (except for rounding errors).
The first result should be similar to the other two.</p>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h3>
<p>At the end of the day, we can reject the null hypothesis that the
sample mean equals <span class="math inline">\(\mu_0\)</span> at a 5%
significance level. We conclude that the mice fed with the special diet
have a different average weight than the known average weight of mice
fed with a ânormalâ diet.</p>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</div></section><section id="aio-08-two-sample-t-test"><p>Content from <a href="08-two-sample-t-test.html">The two-sample and paired t-test</a></p>
<hr>
<p> Last updated on 2023-05-09 | 
        
        <a href="https://github.com/carpentries/workbench-template-rmd/edit/main/episodes/08-two-sample-t-test.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How is the one-sample t-test extended to two samples?<br>
</li>
<li>What is pairing?</li>
<li>What is pairing good for?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Introduce two-sample and paired t-test.</li>
<li>Introduce the concept of statistical power.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="the-two-sample-t-test"><h2 class="section-heading">The two-sample t-test<a class="anchor" aria-label="anchor" href="#the-two-sample-t-test"></a>
</h2>
<hr class="half-width">
<p>So far, I explained the t-test using one sample that was compared to
a known number. More commonly, two samples are compared. For example, in
the scenario I depicted at the beginning of this tutorial, the sample of
mice on high fat diet were compared to a group of mice fed with a
control diet.</p>
<figure><img src="fig/08-two-sample-t-test-rendered-unnamed-chunk-2-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>The approach for testing stays the same. We still summarize the data
into a statistic called <span class="math inline">\(t\)</span> and then
calculate its probability under the null hypothesis.</p>
<p>The only thing that changes is the formula for <span class="math inline">\(t\)</span>. For two samples, itâs<br><span class="math display">\[t= \frac{\bar{x}-\bar{y}}{SE}\]</span> with
<span class="math display">\[SE=
\sqrt{\frac{\hat{\sigma}_x^2+\hat{\sigma}_y^2}{n}}.\]</span></p>
<p>for equal variances and sample size. If <span class="math inline">\(H_0\)</span> is correct, <span class="math inline">\(t\)</span> follows a t-distribution with <span class="math inline">\(n_x+n_y-2\)</span> degrees of freedom.</p>
<p>This means <span class="math inline">\(t\)</span> still compares
effect size, sample size and variance. The effect size is now the
difference between the two sample means.</p>
<p>The formula gets more complicated when the assumptions of equal
variances and sample sizes donât hold, which is often the case. But the
good news is: You donât have to remember any of these formulae, nor the
parameters of the null distribution. Any statistics program will do this
for you. The important thing is that you know how to interpret the
results.</p>
<p>By the way, for the two samples comparing the diets, we get <span class="math inline">\(t=-2.05\)</span> and a p-value of <span class="math inline">\(p=0.053\)</span>. For this sample, we canât reject
the null hypothesis at a 5% significance level. Fortunately, the data
for this example was only a small subset of the original data set. The
researchers who performed the experiment had enough data points (and
thus evidence) to <a href="https://doi.org/10.2337/diabetes.53.suppl_3.S215" class="external-link">clearly
demonstrate that the high-fat diet leads to heaver mice</a>.</p>
</section><section id="pairing-data"><h2 class="section-heading">Pairing data<a class="anchor" aria-label="anchor" href="#pairing-data"></a>
</h2>
<hr class="half-width">
<p>Letâs assume the experiment had looked a little different: Letâs say
there is only one group of mice, and each mouse in that group was
measured, then fed with special diet for a month, and then measured
again. For each mouse we have now two data points. This is visualized
below:</p>
<figure><img src="fig/08-two-sample-t-test-rendered-unnamed-chunk-3-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>We see a trend that after one month, the mice might be a bit heavier.
The difference in means is <span class="math inline">\(2.06\,g\)</span>,
but due to the high variance, a non-paired two-sample t-test is not
significant (<span class="math inline">\(p=0.31\)</span>).</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">t.test</span><span class="op">(</span><span class="va">Bodyweight</span> <span class="op">~</span> <span class="va">Time</span>, data<span class="op">=</span><span class="va">paired_mice</span>, paired<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Welch Two Sample t-test

data:  Bodyweight by Time
t = -1.037, df = 27.899, p-value = 0.3086
alternative hypothesis: true difference in means between group before and group after is not equal to 0
95 percent confidence interval:
 -6.148611  2.015965
sample estimates:
mean in group before  mean in group after 
            24.64443             26.71076 </code></pre>
</div>
<p>However, this test completely neglects the information of which two
data points come from the same mouse. Therefore, letâs consider another
plot, where each two data points that belong to the same mouse are
connected with a line. We say that these data points are <em>paired</em>
by the mouse identity.</p>
<figure><img src="fig/08-two-sample-t-test-rendered-unnamed-chunk-5-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Now it seems clear that each mouse gained a small amount of weight,
something that has been obscured before by the high variance of the
individual mice weights. In fact, we can also plot the individual weight
differences only (right plot) to make the point that every single mouse
has gained a small amount of weight.</p>
<p>The paired t-test is based on the individual difference between
paired data points. It has the null hypothesis that these differences
are zero. This brings the scenario down to a one-sample t-test: We look
at the individual weight differences and test whether they are different
from zero. The estimated effect size, namely the weight difference,
stays the same. But the p-value drops dramatically, as you can see in
the below code:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">t.test</span><span class="op">(</span><span class="va">Bodyweight</span> <span class="op">~</span> <span class="va">Time</span>, data<span class="op">=</span><span class="va">paired_mice</span>, paired<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Paired t-test

data:  Bodyweight by Time
t = -8.9263, df = 14, p-value = 3.742e-07
alternative hypothesis: true mean difference is not equal to 0
95 percent confidence interval:
 -2.562816 -1.569830
sample estimates:
mean difference 
      -2.066323 </code></pre>
</div>
</section><section id="pairing-increases-power"><h2 class="section-heading">Pairing increases power<a class="anchor" aria-label="anchor" href="#pairing-increases-power"></a>
</h2>
<hr class="half-width">
<p>Therefore we say that the paired t-test has an increased power
compared to the unpaired two-sample t-test. Power describes the chance
of detecting an effect with your test, if this effect exists. In this
example, there is an effect (I can assure you, because I simulated the
data). And the paired test detected it, while the unpaired didnât. The
reason is simple: There are two sources of randomness in the data:</p>
<ul>
<li>The individual responses to the treatment and</li>
<li>mice have different weights to start with.</li>
</ul>
<p>In the paired design, we can control for the latter of these sources
of noise.</p>
<div id="diving-seals" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="diving-seals" class="callout-inner">
<h3 class="callout-title">Diving seals<a class="anchor" aria-label="anchor" href="#diving-seals"></a>
</h3>
<div class="callout-content">
<p>(This exercise is from Whitlock and Schluter (2015).)</p>
<p>Weddell Seals take long, exhausting dives to feed on fish.
Researchers wanted to test whether the sealsâ exhaustion comes from
diving alone, or whether feeding itself is also energetically expensive.
They compared the oxygen consumption (<span class="math inline">\(ml\,O_2/kg\)</span>) of feeding and non-feeding
dives that lasted the same amount of time, in the same individual.</p>
<p>The measurements of 10 individuals are summarized in the
<code>oxygen_data</code> data frame as follows:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">oxygen_data</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span></span>
<span>  type <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fu">rep</span><span class="op">(</span><span class="st">"non-feeding"</span>,<span class="fl">10</span><span class="op">)</span>,<span class="fu">rep</span><span class="op">(</span><span class="st">"feeding"</span>,<span class="fl">10</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  individual <span class="op">=</span> <span class="fu">as.character</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  consumption <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">42.2</span>,<span class="fl">51.7</span>,<span class="fl">59.8</span>,<span class="fl">66.5</span>,<span class="fl">81.9</span>,<span class="fl">82.0</span>,<span class="fl">81.3</span>,<span class="fl">81.3</span>,<span class="fl">96.0</span>,<span class="fl">104.1</span>,</span>
<span>                  <span class="fl">71.0</span>,<span class="fl">77.3</span>,<span class="fl">82.6</span>,<span class="fl">96.1</span>,<span class="fl">106.6</span>,<span class="fl">112.8</span>,<span class="fl">121.2</span>,<span class="fl">126.4</span>,<span class="fl">127.5</span>,<span class="fl">143.1</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<ol style="list-style-type: decimal">
<li><p>Copy the above lines of code and consider the
<code>oxygen_data</code>. Can you plot the data to compare the oxygen
consumption in a feeding and non-feeding dive?</p></li>
<li><p>Perform a paired t-test that compares feeding and non-feeding
dives. You can either combine <code>filter</code>and <code>pull</code>
to extract two vectors from the data frame, or use the
<code>t.test</code> in conjunction with a formula.</p></li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<ol style="list-style-type: decimal">
<li>plotting the data</li>
</ol>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">oxygen_data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">type</span>, y<span class="op">=</span><span class="va">consumption</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>group<span class="op">=</span><span class="va">individual</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<ol start="2" style="list-style-type: decimal">
<li>paired t-test</li>
</ol>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># extract two vectors and perform the test</span></span>
<span><span class="va">feeding</span> <span class="op">&lt;-</span> <span class="va">oxygen_data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">type</span><span class="op">==</span><span class="st">"feeding"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">pull</span><span class="op">(</span><span class="va">consumption</span><span class="op">)</span></span>
<span><span class="va">nonfeeding</span> <span class="op">&lt;-</span> <span class="va">oxygen_data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">type</span><span class="op">==</span><span class="st">"non-feeding"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">pull</span><span class="op">(</span><span class="va">consumption</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">t.test</span><span class="op">(</span><span class="va">feeding</span>,<span class="va">nonfeeding</span>,</span>
<span>       paired<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co"># OR</span></span>
<span><span class="fu">t.test</span><span class="op">(</span><span class="va">consumption</span><span class="op">~</span><span class="va">type</span>, data<span class="op">=</span><span class="va">oxygen_data</span>, paired<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</section></section><section id="aio-09-interpreting-p-values"><p>Content from <a href="09-interpreting-p-values.html">Interpreting p-values</a></p>
<hr>
<p> Last updated on 2023-05-03 | 
        
        <a href="https://github.com/carpentries/workbench-template-rmd/edit/main/episodes/09-interpreting-p-values.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What are common mistakes when interpreting p-values?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Emphasize the importance of effect size to go along with
p-values</li>
<li>Point out common mistakes when interpreting p-values and how to
avoid them</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>Have a look at this plot:</p>
<figure><img src="fig/09-interpreting-p-values-rendered-irrelevant-diff-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>The responses in two treatment groups A and B were compared to decide
whether the new treatment B has a different effect than the well-known
treatment A. All measurements are shown, and a p-value of an unpaired
two-sample t-test was reported.</p>
<p>Have a coffee and think about what you conclude about the new
treatmentâ¦</p>
<figure><img src="fig/A_small_cup_of_coffee.JPG" alt="image showing a cup of coffee" width="500" class="figure mx-auto d-block"><figcaption>Have a coffee! (Image: Wikimedia)</figcaption></figure><p>So, if you were in pharmaceutical business: Would you decide to
continue research on treatment B? It evokes a higher (presume: better)
response than A, and will therefore sell better. The difference is
clearly significant. Rightâ¦?<br>
Yes, right. But how much better is the response in B? The average
difference in response is <span class="math inline">\(0.2\)</span>,
which is only 2%. To distract from that, the y-axis of the above graph
starts at 7 â while to be honest with the viewer, it should start at
zero. Remember that a p-value can be small due to a large effect size,
low variance, or large sample size. In this case, itâs the latter. A
huge number of data points will make even the smallest difference
statistically significant. It is questionable whether an improvement of
2% is biologically relevant, and make drug B the new bestseller.<br>
The lesson to be learned here is therefore, that <strong>statistically
significant is not the same as biologically relevant</strong>, and
reporting, or relying on a p-value alone will not give the full picture.
You should always report the effect size as well, and ideally also show
the data.</p>
<p><strong>Note</strong>: In other fields, 2% can, of course, be a
highly relevant difference.</p>
<div class="section level3">
<h3 id="other-fallacies-to-be-aware-of">Other fallacies to be aware of<a class="anchor" aria-label="anchor" href="#other-fallacies-to-be-aware-of"></a>
</h3>
<ul>
<li>The p-value is the probability that the observed data could happen,
under the condition that the null hypothesis is true. It is <em>not</em>
the probability that the null hypothesis is true.<br>
</li>
<li>Keep in mind that <strong>absence of evidence is not evidence of
absence</strong>. If you didnât see a significant effect, it doesnât
mean that there is no effect. It could also be that your data simply
doesnât hold enough evidence to demonstrate it â i.e.Â you have too
little data points for the given variance and effect size.<br>
</li>
<li>
<strong>Significance levels are arbitrary.</strong> It therefore
makes no sense to interpret a p-value of <span class="math inline">\(p=0.049\)</span> much different from <span class="math inline">\(p=0.051\)</span>. They are both suggesting that
there is likely something to see in your data that is worth following
up, and none of them should terminally convince us that the alternative
hypothesis is true.</li>
</ul>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</div></section><section id="aio-10-summary"><p>Content from <a href="10-summary.html">Summary and practical aspects</a></p>
<hr>
<p> Last updated on 2023-05-11 | 
        
        <a href="https://github.com/carpentries/workbench-template-rmd/edit/main/episodes/10-summary.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<p>I hope this tutorial allowed you to notice a pattern in the tests you
have seen.</p>
<figure><img src="fig/cookbook.png" alt="Image of a cookbook for statistical tests" width="150" class="figure mx-auto d-block"><figcaption>Cookbook (image adapted from kindpng.com)</figcaption></figure><p>The âcook bookâ for a test goes as follows:</p>
<ol style="list-style-type: decimal">
<li><p>Set up a <strong>hypothesis <span class="math inline">\(H_0\)</span></strong> that you want to
reject.</p></li>
<li><p>Find a <strong>test statistic</strong> that should be sensitive
to deviations from <span class="math inline">\(H_0\)</span>.</p></li>
<li><p>Find the <strong>null distribution</strong> of the test statistic
â the distribution that it follows under the null hypothesis.</p></li>
<li><p>Compute the actual value of the test statistic.</p></li>
<li><p>Compute the <strong>pâvalue</strong>: The probability of seeing a
value as least as extreme as the computed value in the null
distribution.</p></li>
<li><p>Decide (based on significance level) whether to reject the null
hypothesis.</p></li>
</ol>
<div class="section level3">
<h3 id="cook-book-in-practice">Cook book in practice<a class="anchor" aria-label="anchor" href="#cook-book-in-practice"></a>
</h3>
<p>In practice, you usually donât have to perform steps 2-6 on your own
â standard procedures, i.e.Â statistical tests, exist for most kind of
data, and the computer does the calculation for you. Soâ¦ what is left
for you to do?</p>
<figure><img src="fig/in_practice.png" alt="Computer screen executing wilcoxon test" width="150" class="figure mx-auto d-block"><figcaption>In practice (image adapted from kindpng.com)</figcaption></figure><ol style="list-style-type: decimal">
<li><p>Look at your data!</p></li>
<li><p>Decide on a distribution that your data follow.</p></li>
<li><p>Possibly transform your data to match a suitable distribution
(suitable means: a convenient test is available for this
distribution).</p></li>
<li><p>Find a test that answers your question and is suitable for the
distribution the properties of your data.</p></li>
<li><p>Perform the test and decide. Report the p-value <em>and</em> the
effect size.</p></li>
</ol>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</div></section><section id="aio-11-references"><p>Content from <a href="11-references.html">References</a></p>
<hr>
<p> Last updated on 2023-05-03 | 
        
        <a href="https://github.com/carpentries/workbench-template-rmd/edit/main/episodes/11-references.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="section level3">
<h3 id="books">Books<a class="anchor" aria-label="anchor" href="#books"></a>
</h3>
<ul>
<li>Whitlock, Michael, and Dolph Schluter. The analysis of biological
data. Vol. 768. Roberts Publishers, 2015.</li>
</ul>
</div>
<div class="section level3">
<h3 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h3>
<p>The mice data originate from:</p>
<ul>
<li>Winzell, M. S., &amp; AhrÃ©n, B. (2004). The high-fat diet-fed mouse:
A model for studying mechanisms and treatment of impaired glucose
tolerance and type 2 diabetes. Diabetes, 53(SUPPL. 3).</li>
</ul>
<p>Data are were downloaded <a href="https://raw.githubusercontent.com/genomicsclass/dagdata/master/inst/extdata/mice_pheno.csv" class="external-link">here</a>.</p>
<p>You may download them as follows:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mice_data</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span>file<span class="op">=</span> <span class="fu">url</span><span class="op">(</span><span class="st">"https://raw.githubusercontent.com/genomicsclass/dagdata/master/inst/extdata/mice_pheno.csv"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="images">Images<a class="anchor" aria-label="anchor" href="#images"></a>
</h3>
<ul>
<li><p>Coffee: By Julius Schorzman - Own work, CC BY-SA 2.0, <a href="https://commons.wikimedia.org/w/index.php?curid=107645" class="external-link uri">https://commons.wikimedia.org/w/index.php?curid=107645</a></p></li>
<li><p>Cook book: adapted from <a href="https://www.kindpng.com/downpng/oJwTbo_book-clipart-square-blank-book-cover-clip-art/" class="external-link uri">https://www.kindpng.com/downpng/oJwTbo_book-clipart-square-blank-book-cover-clip-art/</a><br></p></li>
<li><p>Laptop: adapted from <a href="https://www.kindpng.com/downpng/TTJTJb_images-of-laptop-icon-vector-png-mockup-computer/" class="external-link uri">https://www.kindpng.com/downpng/TTJTJb_images-of-laptop-icon-vector-png-mockup-computer/</a><br></p></li>
<li><p>t-distribution: By Skbkekas - Own work, CC BY 3.0, <a href="https://commons.wikimedia.org/w/index.php?curid=9546828" class="external-link uri">https://commons.wikimedia.org/w/index.php?curid=9546828</a></p></li>
<li><p>fireworks: <a href="https://www.pngwing.com" class="external-link uri">https://www.pngwing.com</a></p></li>
</ul>
</div>
<div class="section level3">
<h3 id="teaching-materials">Teaching materials<a class="anchor" aria-label="anchor" href="#teaching-materials"></a>
</h3>
<p>The slides are loosely based on a lecture by Bernd Klaus and Wolfgang
Huber:</p>
<ul>
<li><a href="https://www-huber.embl.de//users/klaus/teaching.html#hypothesis_testing" class="external-link uri">https://www-huber.embl.de//users/klaus/teaching.html#hypothesis_testing</a></li>
</ul>
<p>The demonstration in R roughly follows an example from this
course:</p>
<ul>
<li><a href="https://rafalab.github.io/pages/harvardx.html" class="external-link uri">https://rafalab.github.io/pages/harvardx.html</a></li>
</ul>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</div></section>
</div>
    </main>
</div>
<!-- END  : inst/pkgdown/templates/content-extra.html -->

      </div>
<!--/div.row-->
      		<footer class="row footer mx-md-3"><hr>
<div class="col-md-6">
				<p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>
        
        <a href="https://github.com/carpentries/workbench-template-rmd/edit/main/README.md" class="external-link">Edit on GitHub</a>
        
	
        | <a href="https://github.com/carpentries/workbench-template-rmd/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a> 
        | <a href="https://github.com/carpentries/workbench-template-rmd/" class="external-link">Source</a></p>
				<p><a href="https://github.com/carpentries/workbench-template-rmd/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:sarah.kaspar@embl.de">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">
        
        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>
        
        <p><a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">Template licensed under CC-BY 4.0</a> by <a href="https://carpentries.org" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.12.3" class="external-link">sandpaper (0.12.3)</a>,
        <a href="https://github.com/carpentries/pegboard" class="external-link">pegboard (0.5.3)</a>,
      and <a href="https://github.com/carpentries/varnish/tree/0.2.17" class="external-link">varnish (0.2.17)</a>.</p>
			</div>
		</footer>
</div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
			<i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back to top"></i><br><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://carpentries.github.io/workbench-template-rmd/aio.html",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "statistics, R, hypothesis testing, scientific coding",
  "name": "All in One View",
  "creativeWorkStatus": "active",
  "url": "https://carpentries.github.io/workbench-template-rmd/aio.html",
  "identifier": "https://carpentries.github.io/workbench-template-rmd/aio.html",
  "dateCreated": "2023-05-11",
  "dateModified": "2023-06-13",
  "datePublished": "2023-06-13"
}

  </script><script>
		feather.replace();
	</script><!-- Matomo
    2022-11-07: we have gotten a notification that we have an overage for our
    tracking and I'm pretty sure this has to do with Workbench usage.
    Considering that I am not _currently_ using this tracking because I do not
    yet know how to access the data, I am turning this off for now.
  <script>
    var _paq = window._paq = window._paq || [];
    /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
    _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
    _paq.push(["setDomains", ["*.preview.carpentries.org","*.datacarpentry.github.io","*.datacarpentry.org","*.librarycarpentry.github.io","*.librarycarpentry.org","*.swcarpentry.github.io", "*.carpentries.github.io"]]);
    _paq.push(["setDoNotTrack", true]);
    _paq.push(["disableCookies"]);
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
          var u="https://carpentries.matomo.cloud/";
          _paq.push(['setTrackerUrl', u+'matomo.php']);
          _paq.push(['setSiteId', '1']);
          var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
          g.async=true; g.src='https://cdn.matomo.cloud/carpentries.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
        })();
  </script>
  End Matomo Code -->
</body>
</html><!-- END:   inst/pkgdown/templates/layout.html-->

